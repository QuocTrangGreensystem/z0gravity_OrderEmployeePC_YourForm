<?php$view_content = $this->Xml->unserialize($view_content);App::import("vendor", "str_utility");	$str_utility = new str_utility();	$title = __("Project AMR of ".$project_name,true);	$excel->addTitle($title);	$head = array('No','Title','Content');	$excel->addRowHead($head);	$i=0;	foreach ($view_content as $key=>$value) {							if (isset($value["ProjectDetail"])) {			foreach ($value["ProjectDetail"] as $key1=>$value1) {				if (!is_array($value1)) {				unset($view_content["UserView"]["ProjectDetail"]);				$view_content["UserView"]["ProjectDetail"]['0'] = $value["ProjectDetail"];				}			}		}		if (isset($value["ProjectAmr"])) {			foreach ($value["ProjectAmr"] as $key1=>$value1) {			if (!is_array($value1)) {			unset($view_content["UserView"]["ProjectAmr"]);			$view_content["UserView"]["ProjectAmr"]['0'] = $value["ProjectAmr"];			}			}		}		}	  foreach ($view_content as $key=>$value) {		foreach ($value["ProjectAmr"] as $key1=>$value1) {			foreach ($value1 as $field_name=>$alias) {							switch($field_name){									case 'weather':{						$excel->addRow(array("","Weather",$weather));break;					}					case 'project_amr_program_id':{						$excel->addRow(array("","Program",$amr_program));break;					}					case 'project_amr_sub_program_id':{						$excel->addRow(array("","Sub Program",$amr_sub_program));break;					}					case 'project_amr_category_id':{						$excel->addRow(array("","Category",$amr_category));break;					}					case 'project_amr_sub_category_id':{						$excel->addRow(array("","Sub category",$amr_sub_category));break;					}					case 'project_manager_id':{						$excel->addRow(array("","Project Manager",$project_manager));break;					}					case 'budget':{						$excel->addRow(array("","Budget",$budget." ".$currency));break;					}					case 'project_amr_status_id':{						$excel->addRow(array("","Status",$amr_status));break;					}					case 'project_phases_id':{						$excel->addRow(array("","Current Phase",$amr_phase));break;					}					case 'project_amr_cost_control_id':{						$excel->addRow(array("","Cost Control",$amr_cost_control));break;					}					case 'project_amr_organization_id':{						$excel->addRow(array("","Organization",$amr_organization));break;					}					case 'project_amr_plan_id':{						$excel->addRow(array("","Planning",$amr_plan));break;					}					case 'project_amr_perimeter_id':{						$excel->addRow(array("","Perimeter",$amr_perimeter));break;					}					case 'project_amr_risk_control_id':{						$excel->addRow(array("","Risk Control",$amr_risk_control));break;					}					case 'project_amr_problem_control_id':{						$excel->addRow(array("","Problem control",$amr_problem_control));break;					}					case 'project_amr_risk_information':{						$excel->addRow(array("","Risk information",$amr_risk_info));break;					}					case 'project_amr_problem_information':{						$excel->addRow(array("","Problem ",$amr_problem_info));break;					}					case 'project_amr_solution':{						$excel->addRow(array("","Solution ",$amr_solution));break;					}					case 'project_amr_solution_description':{						$excel->addRow(array("","Solution description",$amr_solution_decs));break;					}					case 'project_amr_mep_date':{						$excel->addRow(array("","MEP date",$str_utility->convertToVNDate($mepdate)));break;					}					case 'project_amr_progression':{						$excel->addRow(array("","Progression",$progress));break;					}								}			}		}	}		$file = $title;	$excel->render($file);	?>